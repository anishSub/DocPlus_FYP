{% extends 'base/base.html' %}
{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/find_hospital/hospital_registration.css' %}">
{% endblock %}

{% block content %}
<div class="registration-wrapper">
    
    <div class="registration-header">
          <div class="container main-container">
              <a href="/" class="back-link"><i class="fas fa-chevron-left"></i> Back to Home</a>
              <div class="header-content">
                  <div>
                      <h1>Register Your Hospital</h1>
                      <p>Join DocPlus and connect with patients across Nepal</p>
                  </div>
                  <div class="hospital-icon-badge">
                      <i class="far fa-hospital"></i>
                  </div>
              </div>
          </div>
    </div>

    <div class="container main-container">
        
        <div class="stepper-wrapper">
            <div class="step-indicator">
                <div class="step active" id="step-indicator-0">
                    <div class="circle">1</div>
                    <div class="label">Identity</div>
                </div>
                <div class="line"></div>
                
                <div class="step" id="step-indicator-1">
                    <div class="circle">2</div>
                    <div class="label">Capacity & Details</div>
                </div>
                <div class="line"></div>

                <div class="step" id="step-indicator-2">
                    <div class="circle">3</div>
                    <div class="label">Media & Hours</div>
                </div>
            </div>
        </div>

        <form id="hospitalRegForm" action="{% url 'hospital_registration' %}" method="POST" enctype="multipart/form-data">
            {% csrf_token %}

            <div class="form-step active" id="step-0">
                <div class="step-header">
                    <div class="icon-box"><i class="far fa-building"></i></div>
                    <div>
                        <h2>Hospital Identity</h2>
                        <p>Enter your hospital's basic information</p>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group full-width">
                        <label>Hospital Name *</label>
                        <input type="text" name="name" placeholder="e.g., Grande International Hospital" required>
                    </div>

                    <div class="form-group">
                        <label>Hospital Type *</label>
                        <select name="hospital_type" required>
                            <option value="">Select Hospital Type</option>
                            <option value="General">General Hospital</option>
                            <option value="Multi-Specialty">Multi-Specialty Hospital</option>
                            <option value="Teaching">Teaching Hospital</option>
                            <option value="Super-Specialty">Super-Specialty Hospital</option>
                            <option value="Children">Children Hospital</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Established Year *</label>
                        <input type="date" name="established_year" placeholder="e.g., 2010" required>
                    </div>

                    <div class="form-group">
                        <label>Contact Number *</label>
                        <input type="tel" name="phone" placeholder="+977 01-XXXXXXX" required>
                    </div>

                    <div class="form-group">
                        <label>Email Address *</label>
                        <input type="email" name="email" placeholder="info@hospital.com" required>
                    </div>

                    <div class="form-group">
                        <label>Password *</label>
                        <div class="input-wrapper">
                            <i class="fas fa-lock input-icon"></i>
                            <input type="password" name="password" id="hosp_pass" placeholder="Create a strong password" required>
                            <i class="fas fa-eye toggle-password-btn" onclick="togglePassword('hosp_pass', this)"></i>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Confirm Password *</label>
                        <div class="input-wrapper">
                            <i class="fas fa-lock input-icon"></i>
                            <input type="password" name="password_confirm" id="hosp_pass_confirm" placeholder="Re-enter password" required>
                            <i class="fas fa-eye toggle-password-btn" onclick="togglePassword('hosp_pass_confirm', this)"></i>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>City *</label>
                        <input type="text" name="city" placeholder="Kathmandu" required>
                    </div>

                    <div class="form-group">
                        <label>District *</label>
                        <input type="text" name="district" placeholder="Kathmandu" required>
                    </div>

                    <div class="form-group full-width">
                        <label>Website (Optional)</label>
                        <input type="url" name="website" placeholder="https://www.hospital.com">
                    </div>

                    <div class="form-group full-width">
                        <label>Full Address *</label>
                        <textarea name="address" rows="2" placeholder="Enter complete hospital address" required></textarea>
                    </div>
                </div>
            </div>

            <div class="form-step" id="step-1">
                <div class="step-header">
                    <div class="icon-box"><i class="fas fa-procedures"></i></div>
                    <div>
                        <h2>Capacity & Details</h2>
                        <p>Provide information about capacity and services</p>
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label>Total Beds *</label>
                        <input type="number" name="total_beds" placeholder="e.g., 200" required>
                    </div>

                    <div class="form-group">
                        <label>Total Doctors *</label>
                        <input type="number" name="total_doctors" placeholder="e.g., 50" required>
                    </div>

                    <div class="form-group full-width">
                        <label>About Hospital *</label>
                        <textarea name="description" rows="4" placeholder="Describe your hospital, its mission, vision, and what makes it special..." required></textarea>
                    </div>
                </div>

                <div class="services-section">
                    <label class="section-label">Services & Facilities *</label>
                    <p class="section-sub">Select all services available</p>
                    
                    <div class="services-grid">
                        <label class="service-check">
                            <input type="checkbox" name="services" value="ICU">
                            <span>ICU</span>
                        </label>
                        <label class="service-check">
                            <input type="checkbox" name="services" value="NICU">
                            <span>NICU</span>
                        </label>
                        <label class="service-check">
                            <input type="checkbox" name="services" value="Ambulance">
                            <span>Ambulance</span>
                        </label>
                        <label class="service-check">
                            <input type="checkbox" name="services" value="Emergency">
                            <span>Emergency 24/7</span>
                        </label>
                        <label class="service-check">
                            <input type="checkbox" name="services" value="Pharmacy">
                            <span>Pharmacy</span>
                        </label>
                        <label class="service-check">
                            <input type="checkbox" name="services" value="Lab">
                            <span>Laboratory</span>
                        </label>
                        <label class="service-check">
                            <input type="checkbox" name="services" value="X-Ray">
                            <span>X-Ray</span>
                        </label>
                        <label class="service-check">
                            <input type="checkbox" name="services" value="MRI">
                            <span>MRI</span>
                        </label>
                        <label class="service-check">
                            <input type="checkbox" name="services" value="Operation Theater">
                            <span>Operation Theater</span>
                        </label>
                    </div>
                </div>

                <div class="dept-section">
                    <label class="section-label">Departments *</label>
                    <div class="dept-input-group">
                        <input type="text" id="deptInput" placeholder="Type department name">
                        <button type="button" class="btn-add-dept" onclick="addDepartment()">Add</button>
                    </div>
                    <div id="deptTagsContainer" class="dept-tags">
                        </div>
                    <input type="hidden" name="departments" id="hiddenDeptField" required>
                </div>
            </div>

            <div class="form-step" id="step-2">
                <div class="step-header">
                    <div class="icon-box"><i class="far fa-image"></i></div>
                    <div>
                        <h2>Media & Operating Hours</h2>
                        <p>Upload image and set timings</p>
                    </div>
                </div>

                <div class="form-group full-width">
                    <label>Hospital Image *</label>
                    <div class="file-upload-box" onclick="document.getElementById('hosp_img').click()">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Click to upload or drag and drop</p>
                        <small>PNG, JPG (Max 5MB)</small>
                        <input type="file" name="image" id="hosp_img" hidden onchange="previewFile(this)">
                    </div>
                    <div id="file-preview-name" class="file-name-display"></div>
                </div>

                <div class="hours-section">
                    <label class="section-label">Operating Hours</label>
                    
                    <div class="emergency-toggle">
                        <input type="checkbox" id="emergency_toggle" name="emergency_available">
                        <label for="emergency_toggle">
                            <i class="fas fa-ambulance"></i> 24/7 Emergency Services Available
                        </label>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label>OPD Start Time *</label>
                            <input type="time" name="opd_start" required>
                        </div>
                        <div class="form-group">
                            <label>OPD End Time *</label>
                            <input type="time" name="opd_end" required>
                        </div>
                    </div>
                </div>

                <div class="form-group full-width">
                    <label>Achievements (Optional)</label>
                    <input type="text" name="achievements" placeholder="e.g., ISO 9001:2015 Certified">
                </div>
            </div>

            <div class="form-actions">
                <button type="button" id="prevBtn" class="btn-prev" onclick="nextPrev(-1)">
                    Previous
                </button>
                <button type="button" id="nextBtn" class="btn-next" onclick="nextPrev(1)">
                    Next <i class="fas fa-arrow-right"></i>
                </button>
            </div>

        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/find_hospital/hospital_registration.js' %}"></script>
{% endblock %}